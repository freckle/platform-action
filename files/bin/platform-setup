#!/bin/sh
set -eu

if [ $# -ne 2 ]; then
  echo "Usage: platform-setup <TOKEN> <RELEASE>" >&2
  exit 64
fi

token=$1
release=$2
repo=freckle/platform
suffix=x86_64-linux
artifact=platform-$suffix.tar.gz

cd /tmp

ghrd \
  --release "$release" \
  --artifact "$artifact" \
  --output "$PWD" \
  --pat "$token" \
  "$repo"

tar xzvf ./"$artifact"
cd ./platform && make install
